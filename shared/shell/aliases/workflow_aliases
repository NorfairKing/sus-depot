# Taskwarrior

alias t='task'
alias ta='t add'
alias tl='t list'
alias tc='t calendar'

alias tg='t burndown.daily'
alias tgm='t burndown'
alias tgy='t burndown.monthly'
alias c='task context'

#alias in='ta +in'
alias rnd='ta +rnd estimate:5 bpower:A RND:'
alias rndp='rnd RND: New project:'
alias think='in +think wait:+1d Think about:'
alias repay='ta pro:repay'
alias wr='ta +next +wr wait:saturday' # weekly review

webpage_title (){
    link="$1"
    wget -qO- "$link" | perl -l -0777 -ne 'print $1 if /<title.*?>\s*(.*?)\s*<\/title/si'
}


tickle () {
    day=$1
    shift
    in wait:$day $@
}
alias tickle=tickle

task_info () {
    task=$1
    shift
    t $task info $@
}
alias ti=task_info

task_modify () {
    task=$1
    shift
    t $task modify $@
}
alias tm=task_modify

task_modify_estimate () {
    task=$1
    shift
    estimate=$1
    shift
    t $task modify estimate:$estimate
}
alias tes=task_modify_estimate

task_modify_brainpower() {
    task=$1
    shift
    brainpower=$1
    shift
    t $task modify bpower:$brainpower
}
alias tbp=task_modify_brainpower
alias tbpA='t bp:A'
alias tbpB='t bp:B'
alias tbpC='t bp:C'

task_make_waiting () {
    t $1 modify +waiting_for -next
}

alias tmw=task_make_waiting
alias tlw='task list +waiting_for'

task_done () {
    t $1 done
}
alias td=task_done

alias tn='ta +next'

task_make_next () {
    t $1 modify +next
}
alias tmn=task_make_next

task_project_add () {
    project=$1
    shift
    ta pro:$project $@
}

alias tp=task_project_add

task_project_list() {
    tl limit:53 pro:$@ 
}
alias tpl=task_project_list

task_depends () {
    t $1 modify depends:$2
}

alias tdp=task_depends
alias tdep=task_depends

task_annotate () {
    task=$1
    shift
    t $task annotate $*
}
alias tA=task_annotate
alias tan=task_annotate

read_or_review (){
    link="$1"
    title=$(webpage_title $link)
    descr="\"Read and review: $title\""
    id=$(tn +rnr "$descr" bpower:B | sed -n 's/Created task \(.*\)./\1/p')
    echo $id
    echo "task \"$id\" annotate \"$link\""
    task "$id" annotate "$link"
}
alias rnr=read_or_review

task_start (){
    task=$1
    shift
    t $task start $@ 
}
alias ts=task_start


task_deadline (){
    t add +deadline due:"$1" estimate:"0" bpower:"C" "$@"
}

alias deadline=task_deadline

# specific project aliases
alias tblog='tp blog'
alias tlblog='tpl blog'

alias tsm='tp blog_sm'
alias tlsm='tpl blog_sm'

alias ter='tp erasmus'
alias tler='tpl erasmus'

## Blog work aliases

# A blogpost
work_blogpost () {
    post_abb="$1"
    project="blog_$post_abb"
    offset="$2"
    
    task add project:$project Write first draft on $post_abb post due:friday$offset +next
    task add project:$project Find good tags on $post_abb post due:friday$offset
    task add project:$project Write final draft of $post_abb post due:friday$offset
    task add project:$project Put up the $post_abb post due:saturday$offset
}

alias post=work_blogpost

# Post idea
post_idea () {
    task add project:blog +in Post idea:$@
}
alias pi=post_idea

## Journaling
alias j='chronicle enter'
